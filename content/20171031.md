Title: CP PyQt5 視窗程式 (一)
Date: 2017-10-31 13:00
Category: Course
Tags: 2017fall, PyQt5
Slug: kmol-2017-fall-pyqt5-1
Author: yen

2017 年 Fall 的計算機程式課程開始導入 <a href="http://pyqt.sourceforge.net/Docs/PyQt5/modules.html">PyQt5</a> 視窗程式教學, 其中使用 <a href="https://eric-ide.python-projects.org">Eric6</a> 整合開發環境簡化初學者建立視窗表單.

<!-- PELICAN_END_SUMMARY -->

###手動建立 PyQt5 視窗介面

最簡單的 <a href="http://pyqt.sourceforge.net/Docs/PyQt5/modules.html">PyQt5</a> 程式直接利用 <a href="http://doc.qt.io/qt-5/qtwidgets-module.html">QtWidgets</a> 中的 <a href="http://doc.qt.io/qt-5/qwidget.html">QWidget</a> 呈現簡單的視窗, 然後利用 <a href="http://doc.qt.io/qt-5/qapplication.html">QApplication</a> 建立應用程式後, 以應用程式的 <a href="http://doc.qt.io/qt-5/qapplication.html#exec">exec()</a> 方法進入事件迴圈.

<pre class="brush: python">
import sys
from PyQt5 import QtWidgets

app = QtWidgets.QApplication(sys.argv)
win = QtWidgets.QWidget()
win.show()
app.exit(app.exec())
</pre>

特別注意 <a href="http://pyqt.sourceforge.net/Docs/PyQt5/modules.html">PyQt5</a> 模組中的 P 與 Q 為大寫, 而 <a href="http://doc.qt.io/qt-5/qtwidgets-module.html">QtWidgets</a> 中的 Q 與 W 為大寫, <a href="http://doc.qt.io/qt-5/qapplication.html">QApplication</a> 中的 Q 與 A 為大寫, 而 <a href="http://doc.qt.io/qt-5/qwidget.html">QWidget</a> 中的 Q 與 W 為大寫.

另外, 利用 <a href="http://doc.qt.io/qt-5/qwidget.html#show">show()</a> 方法將視窗元件顯示後, 其下的程式流程仍可繼續執行, 而對話框中所使用的 <a href="http://doc.qt.io/qt-5/qapplication.html#exec">exec()</a> 方法將會一直到使用者關閉對話框後, 才會將程式的控制權交回.

<a href="http://doc.qt.io/qt-5/qtwidgets-module.html">QtWidgets</a> 模組提供一組使用者介面元件 (User Interface elements), 用來建立傳統視窗桌面樣式的使用者操作介面.

事件導向的 <a href="http://pyqt.sourceforge.net/Docs/PyQt5/modules.html">PyQt5</a> 程式基本控制流程為:

    建立 QApplication 應用程式物件
    建立視窗元件
    顯示視窗元件
    進入應用程式執行迴圈
    等待使用者所觸發的事件

###以 Eric6 建立 PyQt5 視窗介面

首先使用者必須利用可攜程式環境中的 fossil.exe 2.3 版 fossil clone https://mde1a1.kmol.info/pymcadp 倉儲, 操作指令為:

    選定要 clone 倉儲存檔的目錄, 一般建議為 y:\tmp\fossil 目錄
    更換目錄到倉儲存檔的目錄後, 執行 fossil clone https://mde1a1.kmol.info/pymcadp pymcadp.fossil
    將 pymcadp.fossil 開啟在其目錄下的 wd\pymcadp 目錄
    更換目錄到 wd\pymcadp 後, 執行 fossil open ./../../pymcadp.fossil

將遠端的 pymcadp 倉儲 clone 至近端後, 解開其最新版內容後, 接著就要配合 2017 Fall 的 CP 課程, 在倉儲中的 2017fall 目錄, 存放本學期隨後與課程配合的 Eric6 專案及程式碼, 各學員則配合參考 pymcadp 中的設計與配置, 在自己的倉儲中建立對應的目錄與專案內容.

####啟動 Eric6 IDE

在隨身碟中啟動 Eric6 只要點按 start.bat 後, 在命令列中執行 eric6 即可帶出整合開發環境.

之後, 從下拉式功能表中的 Project, 以 New 建立新專案, 使用者必須設定 Project Properties 畫面如下:

<img src="./../data/images/eric6_project_properties.png"></img>

(以上 2D 圖像表達, 採用 <a href="https://getsharex.com/">ShareX</a> 擷取視窗區域存成圖檔後, 以 <a href="https://www.gimp.org/">GIMP</a> 編輯, 利用 Rectangle Select Tool 選定要以紅線標示的三個區域後, 再透過 <a href="https://www.gimp.org/">GIMP</a> 的 Edit-Stroke Selection 功能, 選擇標示框線的顏色、大小與樣式)